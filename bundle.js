!function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1)}([function(e,t){e.exports=BABYLON},function(e,t,o){"use strict";o.r(t);var r=o(0);const n=.1,i=.4,a=6.1+n;var s;const l={fence:null,wall:null,interior:null,transparent:null,roof:null,foundation:null,paintedWall:null};function p(e,t,o,n,i){let a=null;i&&(a=i.map(e=>new r.Vector4(e[0],e[1],e[2],e[3])));const l=r.MeshBuilder.CreateBox(e,{width:t[0],height:t[1],depth:t[2],faceUV:a},s);return l.material=n,l.position=new r.Vector3(t[0]/2+o[0],t[1]/2+o[1],t[2]/2+o[2]),l}function c(e,t,o,n){const i=r.MeshBuilder.CreateGround(e,{width:t[0],height:t[1]},s);return i.material=n,i.position=new r.Vector3(t[0]/2+o[0],o[1],t[1]/2+o[2]),i}function d(e,t,o){return null==t&&(t=[1.2,1.2]),null==o&&(o=.6),function(e,t,o,r){return[e,t,e+o,t,e+o,t+r,e,t+r]}(e,o,t[0],t[1])}function f(e,t,o,n,i,a,l){const p=t.flat(),c=p.length>>>1,d=new Array(c);let f=0;for(let e=0;e<c;e++)d[e]=new r.Vector3(p[f],0,p[f+1]),f+=2;const u=[];if(o)for(let e of o){const t=e.length>>>1,o=new Array(t);let n=0;for(let i=0;i<t;i++)o[i]=new r.Vector3(e[n],0,e[n+1]),n+=2;u.push(o)}let m=null;l&&(m=l.map(e=>new r.Vector4(e[0],e[1],e[2],e[3])));const h=r.MeshBuilder.ExtrudePolygon("wall",{shape:d,depth:n||.2,holes:u,faceUV:m},s);switch(h.material=i,a){case"front":h.rotation.set(-Math.PI/2,0,0);break;case"back":h.rotation.set(-Math.PI/2,-Math.PI,0);break;case"right":h.rotation.set(-Math.PI/2,-Math.PI/2,0);break;case"left":h.rotation.set(-Math.PI/2,Math.PI/2,0)}return h}function u(e,t){let o;if("number"==typeof t)o=t;else switch(t){case"sliding":o=1.8;break;case"outer":o=.9;break;case"inner":o=.8;break;case"cr":o=.7}return[e,0,e,2.1,e+o,2.1,e+o,0]}function m(e,t,o){const n=new r.TransformNode("fence",s),i=r.MeshBuilder.CreateCylinder("bar",{diameter:.02,height:.8});i.material=l.foundation,i.parent=n;for(let n=0;n<=o;n++){const o=r.Matrix.Translation(n*e,.4,n*t);i.thinInstanceAdd(o,!0)}const a=Math.sqrt(e*e+t*t),p=r.MeshBuilder.CreateCylinder("bar",{diameter:.02,height:o*a}),c=Math.atan2(e,t);return p.rotation.set(Math.PI/2,c,0),p.position.set(e*o/2,.8,t*o/2),p.material=l.foundation,p.parent=n,n}function h(e){let t;switch(e.type){case"box":t=function(e){let t=l[e.material];if(!t&&(t=new r.StandardMaterial("texmat",s),e.texture)){const o=new r.Texture("textures/"+e.texture,s);t.diffuseTexture=o}const o=new r.TransformNode("data.name");return p(e.name,e.size,[0,0,0],t,e.uv).parent=o,o}(e);break;case"wall":t=function(e){let t;t=e.doors?e.doors.map(e=>u(e.x,e.w)):[];const o=Object.assign({points:[e.left,0,t,e.right,0,e.right,e.h,e.left,e.h].flat()},e);return console.log(o),w(o)}(e);break;case"poly":t=w(e);break;case"fence":t=m(e.dx,e.dz,e.n);break;case"stairs":t=function(e,t){const[o,n,i]=e,a=i/(t-1),p=n/t,c=new r.TransformNode("stairs",s),d=r.MeshBuilder.CreateBox("step",{width:o,height:.03,depth:a});d.material=l.foundation,d.parent=c;for(let e=1;e<t;e++){const t=r.Matrix.Translation(0,e*p-.015,(e-.5)*a);d.thinInstanceAdd(t,!0)}return console.log(`Created stairs with rise = ${(100*p).toFixed(1)}cm and run ${(100*a).toFixed(1)}cm`),c}(e.size,e.steps);break;case"solidstairs":t=function(e,t,o,n){const[i,a,l]=e,p=l/(t-1),c=a/t;let d=new Array;if(d.push(new r.Vector3(0,0,0)),n)for(let e of n)d.push(new r.Vector3(e[0],0,e[1]));else d.push(new r.Vector3(l,0,0));for(let e=t-2;e>=0;e--)d.push(new r.Vector3((e+1)*p,0,(e+1)*c)),d.push(new r.Vector3(e*p-.02,0,(e+1)*c)),d.push(new r.Vector3(e*p-.02,0,(e+1)*c-.03)),d.push(new r.Vector3(e*p,0,(e+1)*c-.03));const f=r.MeshBuilder.ExtrudePolygon("wall",{shape:d,depth:i},s);return f.material=o,f}(e.size,e.steps,l[e.material],e.cutout);break;case"table":t=function(e){const[t,o,n]=e,i=.03,a=i/2,c=new r.TransformNode("table",s),d=r.MeshBuilder.CreateBox("leg",{width:i,height:o-i,depth:i});d.material=l.interior,d.parent=c;const f=(o-i)/2;return d.thinInstanceAdd(r.Matrix.Translation(a,f,a),!0),d.thinInstanceAdd(r.Matrix.Translation(t-a,f,a),!0),d.thinInstanceAdd(r.Matrix.Translation(a,f,n-a),!0),d.thinInstanceAdd(r.Matrix.Translation(t-a,f,n-a),!0),p("tabletop",[t,i,n],[0,o-i,0],l.interior).parent=c,c}(e.size);break;case"barstool":t=function(){const e=new r.TransformNode("barstool",s),t=r.MeshBuilder.CreateCylinder("bstop",{height:.05,diameter:.4});t.position.set(0,.65,0),t.material=l.interior,t.parent=e;const o=r.MeshBuilder.CreateCylinder("bsbot",{height:.1,diameterTop:.05,diameterBottom:.3});o.position.set(0,.05,0),o.material=l.interior,o.parent=e;const n=r.MeshBuilder.CreateCylinder("bssup",{height:.65,diameter:.05});return n.position.set(0,.325,0),n.material=l.interior,n.parent=e,e}();break;default:t=new r.TransformNode(e.name)}if(e.rotation&&t.rotation.set(e.rotation[0],e.rotation[1],e.rotation[2]),e.position&&t.position.set(e.position[0],e.position[1],e.position[2]),e.children)for(let o of e.children){h(o).parent=t}return t}function w(e){var t;const o=function(e){const t=e.slice(),o=t.length;for(let e=0;e<o;e++){const o=t[e];if("object"==typeof o&&!Array.isArray(o))switch(o.type){case"door":t[e]=u(o.x,o.w)}}return t}(e.points),n=function(e){let t;if(e){t=e.slice();const o=t.length;for(let e=0;e<o;e++){const o=t[e];if("object"==typeof o&&!Array.isArray(o))switch(o.type){case"window":t[e]=d(o.x,o.size,o.y)}}}else t=null;return t}(e.holes);let i=l[e.material];if(!i&&(i=new r.StandardMaterial("texmat",s),e.texture)){const t=new r.Texture("textures/"+e.texture,s);i.diffuseTexture=t}return f(e.name,o,n,null!==(t=e.thickness)&&void 0!==t?t:.2,i,e.side,e.uv)}const y={description:"Kitchen (interior)",position:[.2,0,6.8],children:[{type:"poly",name:"counter1",points:[0,0,2.4,0,2.4,.6,0,.6],thickness:.9,side:"bottom",texture:"counter1.png",uv:[[0,.6,1,1],[0,0,1,.6],[0,0,0,0]],position:[0,.9,2.4]},{type:"poly",name:"counter2",points:[0,0,1.8,0,1.8,.6,0,.6],thickness:.9,side:"bottom",texture:"counter2.png",uv:[[0,.6,1,1],[0,0,1,.6],[0,0,0,0]],position:[.6,.9,.6],rotation:[0,-Math.PI/2,0]},{type:"poly",name:"bar",points:[0,0,1.8,0,1.8,.87,0,.87],thickness:.4,side:"back",texture:"bar.png",uv:[[0,0,1,1],[0,0,0,0],[0,0,0,0]],position:[1.8,0,.6]},{type:"box",name:"bar_top",size:[2,.03,.6],position:[0,.87,0],material:"interior"},{type:"box",name:"fridge",size:[.6,1.86,.6],position:[3.7,0,0],rotation:[0,-Math.PI/2,0],texture:"fridge.jpg",uv:[[0,0,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]},{type:"barstool",name:"bs1",position:[.4,0,-.3]},{type:"barstool",name:"bs2",position:[1,0,-.3]},{type:"barstool",name:"bs3",position:[1.6,0,-.3]}]},b={name:"stairs_section",description:"Note: should be min 36 inch (91.44) width",position:[6.1,0,.2],children:[{description:"Stairs, lower part",type:"solidstairs",name:"stairs_lower",size:[1,5.8/17,.25],steps:2,position:[-.25,0,0],rotation:[-Math.PI/2,0,0],material:"interior"},{description:"Stairs, upper part",type:"solidstairs",name:"stairs_lower",size:[1,40.6/17,3.25],cutout:[[2.6,0],[2.6,1.42],[3.25,1.42]],steps:14,position:[1,8.7/17,1.05],rotation:[-Math.PI/2,-Math.PI/2,0],material:"interior"},{description:"Left part of opening",type:"poly",name:"stairs_wall_left",points:[0,0,.2,0,.2,2.1,.6,2.1,.2,2.7,0,2.7],position:[0,0,4.5],side:"left",material:"interior"},{description:"Stairs, plateau 1",type:"box",name:"stairs_plateau1",size:[1,2.9/17,1],position:[0,2.9/17,0],material:"interior"},{description:"Stairs, plateau 2",type:"poly",name:"stairs_plateau2",points:[0,1,1,0,1,3.65,0,3.65],side:"bottom",thickness:8.7/17,position:[0,8.7/17,0],material:"interior"}]},g={name:"foundation",children:[{type:"box",name:"house_foundation_back",size:[7.3,i,7],position:[0,0,3],material:"foundation"},{type:"box",name:"house_foundation_front",size:[5.8,i,3],position:[1.5,0,0],material:"foundation"},{type:"box",name:"stepfront_top",size:[3,.2,1.5],position:[3,.2,-1.5],material:"foundation"},{type:"box",name:"stepfront_base",size:[4,.2,2],position:[2.5,0,-2],material:"foundation"},{type:"box",name:"stepleft",size:[.5,.2,2.6],position:[-.5,0,3],material:"foundation"},{type:"box",description:"Step at back of the house",name:"stepback",size:[1.5,.2,.5],position:[2.5,0,10],material:"foundation"}]},_={name:"mainhouse-floor0",position:[0,i,0],children:[{description:"Left wall, front part",type:"wall",name:"floor0_left1",left:0,right:3,h:2.8,material:"wall",side:"left",position:[1.5,0,3.1]},{description:"Left wall, back part",type:"wall",name:"floor0_left2",left:0,right:6.7,h:2.8,doors:[{x:4.6,w:"sliding"}],holes:[{type:"window",x:.4,size:[2.4,.4],y:1.2}],material:"wall",side:"left",position:[0,0,9.8]},{description:"connecting wall for left front and back",type:"box",name:"left-back-front-connect",size:[1.5,2.8,.2],position:[0,0,2.9],material:"wall"},{description:"Bedroom wall 1 floor 0",type:"wall",name:"br1_wall1",left:.2,right:5.1,h:2.8,doors:[{x:.4,w:"inner"},{x:3.8,w:"cr"}],holes:[],material:"wall",side:"left",position:[3.9,0,10]},{description:"Bedroom wall 2 floor 0",type:"box",name:"br1_wall2",size:[3.2,2.8,.2],position:[3.9,0,4.7],material:"wall"},{description:"Bathrooms separation wall floor 0",type:"box",name:"br_floor0_sep",size:[.2,2.8,1.5],position:[4.9,0,4.9],material:"wall"},{description:"Bathrooms/bedroom separation wall floor 0",type:"wall",name:"br_floor0_sep2",left:0,right:3,h:2.8,doors:[{x:2,w:"cr"}],side:"front",position:[4.1,0,6.4],material:"wall"},b,{description:"Ground floor ceiling",type:"poly",name:"ceiling0",texture:"floor1.png",uv:[[0,0,1,1],[0,0,0,0],[0,0,0,0]],points:[.2,.2,7.1,.2,7.1,1.2,6.1,1.2,6.1,4.5,7.1,4.5,7.1,9.8,.2,9.8],thickness:.1,position:[0,2.9,0],side:"bottom"},{description:"Balcony front",type:"box",name:"balcony_front",size:[4,n,1.5],position:[3,2.8,-1.5],material:"wall"},y,{description:"Dinner section interior",name:"dinner",position:[0,0,3],children:[{type:"table",name:"dinner_table",size:[.9,.78,1.8],position:[1.1,0,1],material:"interior"}]},{type:"table",name:"tv_table",size:[.5,.5,1.5],position:[5.6,0,2.1],material:"interior"},{description:"tv",type:"box",size:[1.2,.737,.05],rotation:[0,Math.PI/2,0],texture:"tv.jpg",position:[6,.5,3.5]}]},x={name:"mainhouse-floor1",position:[0,3.3,0],children:[{description:"Left wall",type:"wall",name:"floor1_left1",left:.2,right:9.8,h:2.8,doors:[{x:4.8,w:"sliding"}],holes:[{type:"window",x:1},{type:"window",x:8.1,size:[.6,.6],y:1.5}],material:"wall",side:"left",position:[0,0,10]},{description:"Floor 1 master bedroom separation wall",type:"wall",name:"floor1_mb_sepwall",left:.2,right:6.1,h:2.8,doors:[{x:3.4,w:"inner"}],material:"wall",side:"back",position:[6.3,0,3.1]},{description:"Floor 1 MR stairs cover",name:"floor1_mbr_stairscover",type:"poly",points:[0,1.1,1.75,-.1,1.9,-.1,1.9,0,.2,1.162,.2,2.8,0,2.8],thickness:1,side:"left",position:[6.1,0,3.1],material:"interior"},{description:"Floor 1 MR stairs wall",name:"floor1_mbr_stairswall",type:"poly",points:[0,0,1.7,0,0,1.162],thickness:.1,side:"left",position:[6,0,2.9],material:"interior"},{description:"Floor 1 master bedroom / bathroom",type:"wall",name:"floor1_mb_br_wall",left:.2,right:3,h:2.8,doors:[{x:2,w:"cr"}],material:"wall",side:"right",position:[1.9,0,0]},{description:"Master bedroom cabinet",name:"cabinet_mbr_floor1",type:"box",size:[.6,2.4,1.5],position:[1.9,0,.2],material:"interior"},{description:"Master bedroom bed",name:"bed_mbr_floor1",type:"box",size:[2.1,.53,1.9],position:[3.5,0,2.9],rotation:[0,Math.PI/2,0],texture:"bed_king.jpg",uv:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,1,1],[0,0,0,0]]},{description:"Floor 1 guestroom1 wall front",type:"wall",name:"floor1_gr1_front",left:.2,right:3.2,h:2.8,material:"wall",side:"front",position:[0,0,5.5]},{description:"Floor 1 guestrooms separation wall",type:"wall",name:"floor1_gr_sepwall",left:0,right:4.1,h:2.8,doors:[{x:.2,w:"inner"}],material:"wall",side:"right",position:[3.2,0,5.7]},{description:"Floor 1 guestroom2 wall front",type:"wall",name:"floor1_gr2_front",left:0,right:4,h:2.8,doors:[{x:.2,w:"inner"}],material:"wall",side:"front",position:[3.2,0,7]},{description:"Floor 1 guest bathroom wall 1",type:"wall",name:"floor1_gbr_wall1",left:0,right:2.7,h:2.8,doors:[{x:.7,w:"cr"}],material:"wall",side:"front",position:[4.4,0,5.5]},{description:"Floor 1 guest bathroom wall 2",type:"wall",name:"floor1_gbr_wall2",left:0,right:1.5,h:2.8,material:"wall",side:"left",position:[4.4,0,7.2]},{name:"balcony_front_fence",position:[3,0,-1.5],children:[{type:"fence",name:"balcony_front_fence_front",dx:.2,dz:0,n:20},{type:"fence",name:"balcony_front_fence_left",dx:0,dz:.2,n:7.5},{type:"fence",name:"balcony_front_fence_right",dx:0,dz:.2,n:7.5,position:[4,0,0]}]},{description:"Floor 1 ceiling",type:"box",name:"ceiling1",size:[7.3,n,10],position:[0,2.8,0],material:"wall"}]},M={name:"roof",position:[0,0,0],children:[{type:"poly",name:"main_roof",points:[0,.6,11,0,11,.1,0,.7],thickness:9.3,material:"roof",side:"right",position:[8.3,a,-1]}]};class v extends class{get parent(){return this.root.parent}set parent(e){this.root.parent=e}}{constructor(e,t){super(),this.root=h({name:"mainhouse",position:[2.2,0,3],children:[g,_,x,M,{description:"front texture",name:"mainhouse_front",type:"poly",texture:"mainhouse_front.png",uv:[[0,0,.5,1],[0,0,0,0],[.5,1,1,0]],points:[1.5,0,u(4.1,"outer"),7.3,0,7.3,6.3,0,6.3,0,2.9,1.5,2.9],holes:[d(2,[1.2,1.2],.9),d(5.6,[1.2,1.2],.9),d(3.6,[1.8,2.1],2.9)],side:"front",position:[0,.4,0]},{description:"back texture",name:"mainhouse_back",type:"poly",texture:"mainhouse_back.png",uv:[[0,0,.5,1],[0,0,0,0],[.5,1,1,0]],points:[0,0,u(3.6,"outer"),7.3,0,7.3,5.8,0,5.8],holes:[d(1.1,[1.2,1.2],.9),d(1.1,[1.2,1.2],3.8),d(4.8,[1.2,1.2],3.8)],side:"back",position:[7.3,.4,10]},{description:"right texture",name:"mainhouse_right",type:"poly",texture:"mainhouse_right.png",uv:[[0,0,.5,1],[0,0,0,0],[.5,1,1,0]],points:[.2,0,9.8,0,9.8,5.8,.2,6.3],holes:[d(.4,[.4,1.2],.9),d(.4,[.9,1.2],3.8),d(3.7,[1.2,1.2],3.8)],side:"right",position:[7.3,.4,0]}]}),this.parent=e}}const k={name:"washing_area",position:[1.2,0,10.9],children:[{name:"washing_area_wall",type:"box",size:[.8,1.4,.1],material:"wall"}]},C={name:"outside_kitchen",position:[2.2,0,13],children:[{name:"washing_area_surface",type:"box",size:[2,.05,.6],material:"interior",position:[0,.85,0]}]};const A=document.getElementById("view"),S=new r.Engine(A,!0,{},!0),z=new r.Scene(S);z.clearColor=new r.Color4(.9,.9,1,1),s=z,l.fence=new r.StandardMaterial("fence",s),l.fence.ambientColor=new r.Color3(1,1,1),l.fence.diffuseColor=new r.Color3(.9,.2,.2),l.roof=new r.StandardMaterial("roof",s),l.roof.ambientColor=l.roof.diffuseColor=new r.Color3(.8,.2,.2),l.wall=new r.StandardMaterial("wall",s),l.wall.ambientColor=l.wall.diffuseColor=new r.Color3(.9,.85,.8),l.interior=new r.StandardMaterial("interior",s),l.interior.ambientColor=l.interior.diffuseColor=new r.Color3(.9,.9,.9),l.transparent=new r.StandardMaterial("transparent",s),l.transparent.ambientColor=l.transparent.diffuseColor=new r.Color3(1,0,0),l.transparent.alpha=.3,l.foundation=new r.StandardMaterial("foundation",s),l.foundation.ambientColor=l.foundation.diffuseColor=new r.Color3(1,1,1),l.paintedWall=new r.MultiMaterial("paintedwall",s),l.paintedWall.subMaterials.push(l.wall),l.paintedWall.subMaterials.push(l.foundation);{const e=new r.HemisphericLight("HemiLight",new r.Vector3(0,1,0),z);e.groundColor.set(.5,.5,.5),e.intensity=.5}function B(){return new r.Vector3(5.5,1.6,-10)}const T=new r.FreeCamera("sceneCamera",B(),z);T.minZ=.1,T.maxZ=100,T.fov=1;const P={fromPos:new Float32Array(3),fromRot:new Float32Array(3),toPos:new Float32Array(3),toRot:new Float32Array(3),interp:1};T.attachControl(A),S.runRenderLoop(()=>{z.render()}),T.inputs.removeByType("FreeCameraKeyboardMoveInput"),T.inputs.removeByType("FreeCameraMouseInput"),T.inputs.add(new class{constructor(){this._keys={ArrowLeft:!1,ArrowRight:!1,ArrowUp:!1,ArrowDown:!1,Shift:!1}}attachControl(e){if(this._onCanvasBlurObserver)return;this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add(()=>{this._keys={ArrowLeft:!1,ArrowRight:!1,ArrowUp:!1,ArrowDown:!1,Shift:!1}});const t=(e,t)=>{this._keys.hasOwnProperty(e.key)&&(this._keys[e.key]=t)};this._onKeyboardObserver=this._scene.onKeyboardObservable.add(o=>{let n=o.event;n.metaKey||(t(n,o.type===r.KeyboardEventTypes.KEYDOWN),e||n.preventDefault())})}detachControl(){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onKeyboardObserver=null,this._onCanvasBlurObserver=null),this._keys={ArrowLeft:!1,ArrowRight:!1,ArrowUp:!1,ArrowDown:!1,Shift:!1}}checkInputs(){const e=(e,o,n)=>{t._localDirection.copyFromFloats(e,o,n),t.getScene().useRightHandedSystem&&(t._localDirection.z*=-1),t.getViewMatrix().invertToRef(t._cameraTransformMatrix),r.Vector3.TransformNormalToRef(t._localDirection,t._cameraTransformMatrix,t._transformedDirection),t.cameraDirection.addInPlace(t._transformedDirection)};if(this._onKeyboardObserver){var t=this.camera,o=t._computeLocalCameraSpeed()/10;this._keys.ArrowLeft&&(t.rotation.y-=o,e(0,0,0)),this._keys.ArrowRight&&(t.rotation.y+=o,e(0,0,0)),this._keys.ArrowUp&&(this._keys.Shift?e(0,o,0):e(0,0,o)),this._keys.ArrowDown&&(this._keys.Shift?e(0,-o,0):e(0,0,-o))}}getClassName(){return"FreeCameraKeyboardWalkInput"}_onLostFocus(){this._keys={ArrowLeft:!1,ArrowRight:!1,ArrowUp:!1,ArrowDown:!1,Shift:!1}}getSimpleName(){return"keyboard"}}),new r.DirectionalLight("DirectionalLight",new r.Vector3(.8,-1,.5),z).intensity=1,function(){{const e=new r.StandardMaterial("road",z);e.diffuseColor=new r.Color3(.2,.2,.2),c("road",[40,3],[-10,0,-3.5],e)}{const e=new r.StandardMaterial("curb",z);e.diffuseColor=new r.Color3(.2,.3,.2),c("curb",[40,.5],[-10,0,-.5],e)}}();(function(e){const t=h({name:"lot1",children:[k,C]});{const o=new r.StandardMaterial("land",e);o.diffuseColor=new r.Color3(.8,.8,.8),c("land",[20,15],[0,0,0],o).parent=t}p("fence_back",[11,.8,.1],[0,0,14.9],l.fence).parent=t,p("fence_left",[.1,.8,15],[0,0,0],l.fence).parent=t,p("fence_right",[.1,.8,15],[10.9,0,0],l.fence).parent=t,new v(t,e),function(e,t){const o=i+2.8,n=new r.TransformNode("garage");n.parent=e;const a=f(0,[0,0,4,0,4,3,2,3,2,9,0,9],[],.2,l.wall,"top");a.parent=n,a.position.y=3.3,p("support1",[.3,o,.3],[0,0,0],l.wall).parent=n,p("support2",[.3,o,.3],[3.7,0,0],l.wall).parent=n,p("support3",[.3,o,.3],[0,0,8.7],l.wall).parent=n,p("support4",[.3,o,.3],[0,0,3],l.wall).parent=n}(t),function(e,t){const o=new r.TransformNode("terrace");o.parent=e,o.position.set(0,3.3,0),m(.2,0,20).parent=o,m(0,.2,45).parent=o;const n=m(0,.2,15);n.parent=o,n.position.x=4;const i=m(.2,0,10);i.parent=o,i.position.z=9}(t),m(.2,0,55).parent=t,function(e,t){const o=new r.Texture("textures/floor0.png",t),n=new r.StandardMaterial("floor0_mat",t);n.diffuseTexture=o,n.alpha=.5;const i=r.MeshBuilder.CreateGround("floor0_ref",{width:11,height:15},t);i.material=n,i.position=new r.Vector3(5.5,.41,7.5)}(0,e);{const o=new r.StandardMaterial("grass",e),n=new r.Texture("textures/grass1.jpg",e);o.diffuseTexture=n,n.uScale=4,n.vScale=12,c("grass_right",[2,10],[9,.002,3],o).parent=t}return t})(z).position.x=0,function(){const e=document.getElementById("bMenu"),t=document.getElementById("divMenu"),o=document.createElement("div");function r(e){t.style.display=e?"":"none"}function n(e,t,r){const n=document.createElement("button");n.innerText=e,n.onclick=()=>{T.position.toArray(P.fromPos),T.rotation.toArray(P.fromRot),P.toPos.set(t),P.toRot.set(r),P.interp=0},o.appendChild(n)}o.style.cssText="display: flex; flex-direction: column;",t.appendChild(o),e.onclick=()=>{t.offsetParent?r(!1):r(!0)},n("Front",[5.5,1.6,-10],[0,0,0]),n("Living area",[4.14,2,6.54],[0,1.94,0]),n("Upper floor, MBR",[5.03,4.9,5.64],[0,2.23,0])}(),z.registerBeforeRender(()=>{if(P.interp<1){P.interp+=.02,P.interp>=1&&(P.interp=1);const e=P.interp,t=1-e,o=P.fromPos[0]*t+P.toPos[0]*e,r=P.fromPos[1]*t+P.toPos[1]*e,n=P.fromPos[2]*t+P.toPos[2]*e,i=P.fromRot[0]*t+P.toRot[0]*e,a=P.fromRot[1]*t+P.toRot[1]*e,s=P.fromRot[2]*t+P.toRot[2]*e;T.position.set(o,r,n),T.rotation.set(i,a,s)}}),window.addEventListener("keydown",(function(e){switch(e.key.toUpperCase()){case"R":T.position=B(),T.rotation=new r.Vector3;break;case"0":T.position.y=1.6;break;case"1":T.position.y=2;break;case"2":T.position.y=4.9;break;case"3":T.position.y=a+1.6;break;case"4":if(e.ctrlKey){const e=new Array;T.position.toArray(e),localStorage.setItem("metropolis",JSON.stringify(e))}else{const e=JSON.parse(localStorage.getItem("metropolis"));T.position.set(e[0],e[1],e[2])}break;case"L":{const e=T.position,t=T.rotation,o=[e.x,e.y,e.z].map(e=>Math.round(100*e)/100),r=[t.x,t.y,t.z].map(e=>Math.round(100*e)/100);document.getElementById("divMessage").innerHTML=`position: ${o} rotation: ${r}`}}})),window.onresize=()=>S.resize()}]);