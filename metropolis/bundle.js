!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1)}([function(e,t){e.exports=BABYLON},function(e,t,o){"use strict";o.r(t);var n=o(0);const r=.4+2.8+.4;var a;const i={fence:null,wall:null,interior:null,transparent:null,roof:null,foundation:null,paintedWall:null};function s(e,t,o,r,i){let s=null;i&&(s=i.map(e=>new n.Vector4(e[0],e[1],e[2],e[3])));const l=n.MeshBuilder.CreateBox(e,{width:t[0],height:t[1],depth:t[2],faceUV:s},a);return l.material=r,l.position=new n.Vector3(t[0]/2+o[0],t[1]/2+o[1],t[2]/2+o[2]),l}function l(e,t,o,r){const i=n.MeshBuilder.CreateGround(e,{width:t[0],height:t[1]},a);return i.material=r,i.position=new n.Vector3(t[0]/2+o[0],o[1],t[1]/2+o[2]),i}function c(e,t,o,n){return[e,t,e+o,t,e+o,t+n,e,t+n]}function p(e,t,o,r,i,s,l){const c=t.flat(),p=c.length>>>1,u=new Array(p);let d=0;for(let e=0;e<p;e++)u[e]=new n.Vector3(c[d],0,c[d+1]),d+=2;const f=[];if(o)for(let e of o){const t=e.length>>>1,o=new Array(t);let r=0;for(let a=0;a<t;a++)o[a]=new n.Vector3(e[r],0,e[r+1]),r+=2;f.push(o)}let h=null;l&&(h=l.map(e=>new n.Vector4(e[0],e[1],e[2],e[3])));const w=n.MeshBuilder.ExtrudePolygon("wall",{shape:u,depth:r||.15,holes:f,faceUV:h},a);switch(w.material=i,s){case"front":w.rotation.set(-Math.PI/2,0,0);break;case"back":w.rotation.set(-Math.PI/2,-Math.PI,0);break;case"right":w.rotation.set(-Math.PI/2,-Math.PI/2,0);break;case"left":w.rotation.set(-Math.PI/2,Math.PI/2,0)}return w}function u(e,t,o,r){const[i,s,l]=e,c=l/(t-1),p=s/t;let u=new Array;if(u.push(new n.Vector3(0,0,0)),r)for(let e of r)u.push(new n.Vector3(e[0],0,e[1]));else u.push(new n.Vector3(l,0,0));for(let e=t-2;e>=0;e--)u.push(new n.Vector3((e+1)*c,0,(e+1)*p)),u.push(new n.Vector3(e*c-.02,0,(e+1)*p)),u.push(new n.Vector3(e*c-.02,0,(e+1)*p-.03)),u.push(new n.Vector3(e*c,0,(e+1)*p-.03));const d=n.MeshBuilder.ExtrudePolygon("wall",{shape:u,depth:i},a);return d.material=o,d}function d(e,t,o=2.1){let n;if("number"==typeof t)n=t;else switch(t){case"sliding":n=1.8;break;case"outer":n=.9;break;case"inner":n=.8;break;case"cr":n=.7}return[e,0,e,o,e+n,o,e+n,0]}function f(e,t,o){const r=new n.TransformNode("fence",a),s=n.MeshBuilder.CreateCylinder("bar",{diameter:.02,height:.8});s.material=i.foundation,s.parent=r;for(let r=0;r<=o;r++){const o=n.Matrix.Translation(r*e,.4,r*t);s.thinInstanceAdd(o,!0)}const l=Math.sqrt(e*e+t*t),c=n.MeshBuilder.CreateCylinder("bar",{diameter:.02,height:o*l}),p=Math.atan2(e,t);return c.rotation.set(Math.PI/2,p,0),c.position.set(e*o/2,.8,t*o/2),c.material=i.foundation,c.parent=r,r}function h(e){let t;switch(e.type){case"box":t=function(e){let t=i[e.material];if(!t&&(t=new n.StandardMaterial("texmat",a),e.texture)){const o=new n.Texture("textures/"+e.texture,a);t.diffuseTexture=o}const o=new n.TransformNode("data.name");return s(e.name,e.size,[0,0,0],t,e.uv).parent=o,o}(e);break;case"wall":t=function(e){let t;t=e.doors?e.doors.map(e=>d(e.x,e.w)):[];const o=Object.assign({points:[e.left,0,t,e.right,0,e.right,e.h,e.left,e.h].flat()},e);return console.log(o),w(o)}(e);break;case"poly":t=w(e);break;case"fence":t=f(e.dx,e.dz,e.n);break;case"stairs":t=function(e,t){const[o,r,s]=e,l=s/(t-1),c=r/t,p=new n.TransformNode("stairs",a),u=n.MeshBuilder.CreateBox("step",{width:o,height:.03,depth:l});u.material=i.foundation,u.parent=p;for(let e=1;e<t;e++){const t=n.Matrix.Translation(0,e*c-.015,(e-.5)*l);u.thinInstanceAdd(t,!0)}return console.log(`Created stairs with rise = ${(100*c).toFixed(1)}cm and run ${(100*l).toFixed(1)}cm`),p}(e.size,e.steps);break;case"solidstairs":t=u(e.size,e.steps,i[e.material],e.cutout);break;case"table":t=function(e){const[t,o,r]=e,l=.03,c=l/2,p=new n.TransformNode("table",a),u=n.MeshBuilder.CreateBox("leg",{width:l,height:o-l,depth:l});u.material=i.interior,u.parent=p;const d=(o-l)/2;return u.thinInstanceAdd(n.Matrix.Translation(c,d,c),!0),u.thinInstanceAdd(n.Matrix.Translation(t-c,d,c),!0),u.thinInstanceAdd(n.Matrix.Translation(c,d,r-c),!0),u.thinInstanceAdd(n.Matrix.Translation(t-c,d,r-c),!0),s("tabletop",[t,l,r],[0,o-l,0],i.interior).parent=p,p}(e.size);break;case"barstool":t=function(){const e=new n.TransformNode("barstool",a),t=n.MeshBuilder.CreateCylinder("bstop",{height:.05,diameter:.4});t.position.set(0,.65,0),t.material=i.interior,t.parent=e;const o=n.MeshBuilder.CreateCylinder("bsbot",{height:.1,diameterTop:.05,diameterBottom:.3});o.position.set(0,.05,0),o.material=i.interior,o.parent=e;const r=n.MeshBuilder.CreateCylinder("bssup",{height:.65,diameter:.05});return r.position.set(0,.325,0),r.material=i.interior,r.parent=e,e}();break;default:t=new n.TransformNode(e.name)}if(e.rotation&&t.rotation.set(e.rotation[0],e.rotation[1],e.rotation[2]),e.position&&t.position.set(e.position[0],e.position[1],e.position[2]),e.children)for(let o of e.children){h(o).parent=t}return t}function w(e){var t;const o=function(e){const t=e.slice(),o=t.length;for(let e=0;e<o;e++){const o=t[e];if("object"==typeof o&&!Array.isArray(o))switch(o.type){case"door":t[e]=d(o.x,o.w)}}return t}(e.points),r=function(e){let t;if(e){t=e.slice();const a=t.length;for(let e=0;e<a;e++){const a=t[e];if("object"==typeof a&&!Array.isArray(a))switch(a.type){case"window":t[e]=(o=a.x,n=a.size,r=a.y,null==n&&(n=[1.2,1.2]),null==r&&(r=.6),c(o,r,n[0],n[1]))}}}else t=null;var o,n,r;return t}(e.holes);let s=i[e.material];if(!s&&(s=new n.StandardMaterial("texmat",a),e.texture)){const t=new n.Texture("textures/"+e.texture,a);s.diffuseTexture=t}return p(e.name,o,r,null!==(t=e.thickness)&&void 0!==t?t:.2,s,e.side,e.uv)}const m={description:"Kitchen (interior)",position:[.15,0,7.15],children:[{type:"poly",name:"counter1",points:[0,0,2.4,0,2.4,.6,0,.6],thickness:.9,side:"bottom",texture:"counter1.png",uv:[[0,.6,1,1],[0,0,1,.6],[0,0,0,0]],position:[0,.9,2.4]},{type:"poly",name:"counter2",points:[0,0,1.8,0,1.8,.6,0,.6],thickness:.9,side:"bottom",texture:"counter2.png",uv:[[0,.6,1,1],[0,0,1,.6],[0,0,0,0]],position:[.6,.9,.6],rotation:[0,-Math.PI/2,0]},{type:"poly",name:"bar",points:[0,0,1.8,0,1.8,.87,0,.87],thickness:.4,side:"back",texture:"bar.png",uv:[[0,0,1,1],[0,0,0,0],[0,0,0,0]],position:[1.8,0,.6]},{type:"box",name:"bar_top",size:[2,.03,.6],position:[0,.87,0],material:"interior"},{type:"box",name:"fridge",size:[.6,1.86,.6],position:[3.55,0,0],rotation:[0,-Math.PI/2,0],texture:"fridge.jpg",uv:[[0,0,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]},{type:"barstool",name:"bs1",position:[.4,0,-.3]},{type:"barstool",name:"bs2",position:[1,0,-.3]},{type:"barstool",name:"bs3",position:[1.6,0,-.3]}]};Math.PI;const b={name:"mainhouse-floor1",position:[0,r,0],children:[{description:"Master bedroom cabinet",name:"cabinet_mbr_floor1",type:"box",size:[.6,2.8,1.5],position:[1.25,0,0],material:"interior"},{description:"Master bedroom bed",name:"bed_mbr_floor1",type:"box",size:[2.1,.53,1.9],position:[3.2,0,2.85],rotation:[0,Math.PI/2,0],texture:"bed_king.jpg",uv:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,1,1],[0,0,0,0]]},{description:"Floor 1 ceiling",type:"box",name:"ceiling1",size:[7.3,.4,10],position:[0,2.8,0],material:"wall"}]},y={name:"roof",position:[0,0,0],children:[{type:"poly",name:"main_roof",points:[0,.6,11,0,11,.1,0,.7],thickness:9.3,material:"roof",side:"right",position:[8.3,6.8,-1]}]};class g extends class{get parent(){return this.root.parent}set parent(e){this.root.parent=e}}{constructor(e,t){super(),this.root=h({name:"mainhouse",position:[2.2,0,3],children:[b,y]}),this.parent=e}}var _,x;const M={name:"outside_kitchen",position:[2.2,0,13],children:[{name:"washing_area_surface",type:"box",size:[2,.05,.6],material:"interior",position:[0,.85,0]}]};const v=document.getElementById("view"),C=new n.Engine(v,!0,{},!0),k=new n.Scene(C);k.clearColor=new n.Color4(.9,.9,1,1),a=k,i.fence=new n.StandardMaterial("fence",a),i.fence.ambientColor=new n.Color3(1,1,1),i.fence.diffuseColor=new n.Color3(.9,.2,.2),i.roof=new n.StandardMaterial("roof",a),i.roof.ambientColor=i.roof.diffuseColor=new n.Color3(.8,.2,.2),i.wall=new n.StandardMaterial("wall",a),i.wall.ambientColor=i.wall.diffuseColor=new n.Color3(.9,.9,.9),i.interior=new n.StandardMaterial("interior",a),i.interior.ambientColor=i.interior.diffuseColor=new n.Color3(.9,.9,.9),i.transparent=new n.StandardMaterial("transparent",a),i.transparent.ambientColor=i.transparent.diffuseColor=new n.Color3(1,0,0),i.transparent.alpha=.3,i.foundation=new n.StandardMaterial("foundation",a),i.foundation.ambientColor=i.foundation.diffuseColor=new n.Color3(1,1,1),i.paintedWall=new n.MultiMaterial("paintedwall",a),i.paintedWall.subMaterials.push(i.wall),i.paintedWall.subMaterials.push(i.foundation);{const e=new n.HemisphericLight("HemiLight",new n.Vector3(0,1,0),k);e.groundColor.set(.5,.5,.5),e.intensity=1;new n.DirectionalLight("DirectionalLight",new n.Vector3(.8,-1,.5),k).intensity=.2}function T(){return new n.Vector3(5.5,1.6,-10)}const S=new n.FreeCamera("sceneCamera",T(),k);S.minZ=.1,S.maxZ=100,S.fov=1;const A={fromPos:new Float32Array(3),fromRot:new Float32Array(3),toPos:new Float32Array(3),toRot:new Float32Array(3),interp:1},P={dragStartX:0,dragStartY:0,x:0,y:0,dragging:!1},I=[0,0,0],B=[0,0,0];S.attachControl(v),C.runRenderLoop(()=>{k.render()}),S.inputs.removeByType("FreeCameraKeyboardMoveInput"),S.inputs.removeByType("FreeCameraMouseInput"),S.inputs.add(new class{constructor(){this._keys={ArrowLeft:!1,ArrowRight:!1,ArrowUp:!1,ArrowDown:!1,Shift:!1}}attachControl(e){if(this._onCanvasBlurObserver)return;this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add(()=>{this._keys={ArrowLeft:!1,ArrowRight:!1,ArrowUp:!1,ArrowDown:!1,Shift:!1}});const t=(e,t)=>{this._keys.hasOwnProperty(e.key)&&(this._keys[e.key]=t)};this._onKeyboardObserver=this._scene.onKeyboardObservable.add(o=>{let r=o.event;r.metaKey||(t(r,o.type===n.KeyboardEventTypes.KEYDOWN),e||r.preventDefault())})}detachControl(){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onKeyboardObserver=null,this._onCanvasBlurObserver=null),this._keys={ArrowLeft:!1,ArrowRight:!1,ArrowUp:!1,ArrowDown:!1,Shift:!1}}checkInputs(){const e=(e,o,r)=>{t._localDirection.copyFromFloats(e,o,r),t.getScene().useRightHandedSystem&&(t._localDirection.z*=-1),t.getViewMatrix().invertToRef(t._cameraTransformMatrix),n.Vector3.TransformNormalToRef(t._localDirection,t._cameraTransformMatrix,t._transformedDirection),t.cameraDirection.addInPlace(t._transformedDirection)};if(this._onKeyboardObserver){var t=this.camera,o=t._computeLocalCameraSpeed()/10;this._keys.ArrowLeft&&(t.rotation.y-=o,e(0,0,0)),this._keys.ArrowRight&&(t.rotation.y+=o,e(0,0,0)),this._keys.ArrowUp&&(this._keys.Shift?e(0,o,0):e(0,0,o)),this._keys.ArrowDown&&(this._keys.Shift?e(0,-o,0):e(0,0,-o))}}getClassName(){return"FreeCameraKeyboardWalkInput"}_onLostFocus(){this._keys={ArrowLeft:!1,ArrowRight:!1,ArrowUp:!1,ArrowDown:!1,Shift:!1}}getSimpleName(){return"keyboard"}}),function(){{const e=new n.StandardMaterial("road",k);e.diffuseColor=new n.Color3(.2,.2,.2),l("road",[40,3],[-10,0,-3.5],e)}{const e=new n.StandardMaterial("curb",k);e.diffuseColor=new n.Color3(.2,.3,.2),l("curb",[40,.5],[-10,0,-.5],e)}}();(function(e){_=new n.Texture("textures/ground_level.png",e),x=new n.Texture("textures/upper_level.png",e);const t=h({name:"lot1",children:[M]});{const o=new n.StandardMaterial("land",e);o.diffuseColor=new n.Color3(.8,.8,.8),l("land",[20,15],[0,0,0],o).parent=t}return s("fence_back",[10.8,.8,.15],[0,0,14.85],i.fence).parent=t,s("fence_left",[.15,5,15],[0,0,0],i.wall).parent=t,s("fence_right",[.15,.8,15],[10.65,0,0],i.fence).parent=t,function(e,t,o){const r=new n.StandardMaterial("floor0_mat",o);r.diffuseTexture=_;const a=10.8,l=.2/a,c=.2/15,u=p(0,[3.5,2.85,9.45,2.85,9.45,13.15,1.85,13.15,1.85,5.85,3.5,5.85],[],t,r,"top",[[1.85/a,.19,9.45/a,13.15/15],[l,c,l,c],[l,c,l,c]]);u.position=new n.Vector3(0,t,0),u.parent=e,s("frontstep_level0",[4.15,t/2,1.95],[4.3,0,.9],i.foundation),s("frontstep_level1",[3.35,t,1.55],[4.7,0,1.3],i.foundation),s("leftsteps_level0",[1.7,t/2,7.3],[.15,0,5.85],i.foundation),s("leftsteps_level1",[1.7,t,6.5],[.15,0,6.25],i.foundation)}(t,.4,e),function(e,t,o){const r=new n.TransformNode("house");!function(e,t){const o=new n.TransformNode("outer_walls",t);{const e=new n.Texture("textures/house_front.png",t),r=new n.StandardMaterial("house_front_mat",t);r.diffuseTexture=e;const a=.002/7.6,i=5.98/6;p(0,[1.65,0,4.05,0,4.05,2.1,4.95,2.1,4.95,0,7.6,0,7.6,6,0,6,0,2.8,1.65,2.8],[[2.15,.6,2.95,.6,2.95,2.1,2.15,2.1],[6.45,.6,7.25,.6,7.25,2.1,6.45,2.1],[2.3,4.1,2.9,4.1,2.9,5.3,2.3,5.3],[4.35,3.2-.001,5.95,3.2-.001,5.95,5.3,4.35,5.3]],.15,r,"front",[[0,0,1,1],[a,i,a,i],[1,1,0,0]]).parent=o}{const e=new n.Texture("textures/house_left.png",t),r=new n.StandardMaterial("house_left_mat",t);r.diffuseTexture=e;const a=10,l=6,c=.2/a,u=.2/l,d=p(0,[0,0,3,0,3,2.8,0,2.8],[[1,.9,2.2,.9,2.2,2.1,1,2.1]],.15,r,"left",[[7/a,0,1,2.8/l],[c,u,c,u],[1,2.8/l,7/a,0]]);d.position.set(1.65,0,3.15),d.parent=o;const f=p(0,[0,0,4.15,0,4.15,2.1,5.75,2.1,5.75,0,7.15,0,7.15,3.2,10,3.2,10,6,0,6],[[4.8,3.2-.001,6.4,3.2-.001,6.4,5.3,4.8,5.3],[.2,4.1,.8,4.1,.8,5.3,.2,5.3],[2.5,4.1,3.1,4.1,3.1,5.3,2.5,5.3],[.9,1.3,2.1,1.3,2.1,2.1,.9,2.1],[8.1,4.7,8.7,4.7,8.7,5.3,8.1,5.3]],.15,r,"left",[[0,0,1,1],[c,u,c,u],[1,1,0,0]]);f.position.set(0,0,10.15),f.parent=o;s("house_left_connect",[1.5,2.8,.15],[.15,0,3],i.foundation).parent=o}{const e=new n.Texture("textures/house_right.png",t),r=new n.StandardMaterial("house_right_mat",t);r.diffuseTexture=e;const a=.2/10,i=.2/6,s=p(0,[0,0,10,0,10,6,0,6],[c(.3,.9,.6,1.2),c(5.65,1.5,.6,.6),c(6.75,.9,.6,1.2),c(9.3,.9,.6,1.2),c(.3,4.1,.6,1.2),c(3.65,4.1,1.2,1.2),c(6.05,4.7,.6,.6),c(7.25,4.1,.6,1.2),c(9.3,4.1,.6,1.2)],.15,r,"right",[[0,0,1,1],[a,i,a,i],[1,1,0,0]]);s.position.set(7.6,0,.15),s.parent=o}{const e=new n.Texture("textures/house_back.png",t),r=new n.StandardMaterial("house_back_mat",t);r.diffuseTexture=e;const a=.002/7.6,i=5.98/6,s=p(0,[0,0,d(4.05,.8),7.6,0,7.6,6,0,6],[c(1.25,.9,1.2,1.2),c(1.25,4.1,1.2,1.2),c(5.35,4.1,1.2,1.2)],.15,r,"back",[[0,0,1,1],[a,i,a,i],[1,1,0,0]]);s.position.set(7.6,0,10.3),s.parent=o}o.parent=e}(r,o);{const e=new n.TransformNode("ground_floor",o);e.parent=r;(function(e,t){const o=new n.TransformNode("ground_walls");o.parent=e;const r=p(0,[0,0,d(.2,.8,2.1),d(3.6,.6,2.1),5,0,5,2.8,0,2.8],[],.15,i.wall,"left");r.position.set(3.8,0,10.15),r.parent=o,s("ground_bedroom_wall_front",[3.5,2.8,.15],[3.95,0,5.15],i.wall).parent=o;const a=p(0,[0,0,d(1.5,.7,2.1),3.5,0,3.5,2.8,0,2.8],[],.15,i.wall,"back");a.position.set(7.45,0,6.8),a.parent=o,s("ground_bedroom_pr_wall",[.15,2.8,1.35],[5,0,5.3],i.wall).parent=o})(e),function(e){const t=(2.8+.4)/17,o=new n.TransformNode("stairs"),r=u([1.2,2*t,.25],2,i.interior);r.position.set(-.25,0,0),r.rotation.set(-Math.PI/2,0,0),r.parent=o;const a=3*t,l=u([1.2,14*t,3.25],14,i.interior,[[3.1,0],[3.1,2.1-a],[3.7,2.1-a],[3.7,-a],[3.8,-a],[3.8,2.8-a]]);l.position.set(1.2,a,1.2),l.rotation.set(-Math.PI/2,-Math.PI/2,0),l.parent=o,s("plateau1",[1.2,(2.8+.4)/17,1.2],[0,1*t,0],i.interior).parent=o;const c=p(0,[0,1.2,1.2,0,1.2,4.3,0,4.3],[],a,i.interior,"top");c.position.set(0,a,0),c.parent=o,o.position.set(6.25,0,.15),o.parent=e}(e);{const t=new n.TransformNode("ground_interior");t.parent=e;(function(e,t){const o=h(m);{const e=new n.Texture("textures/kitchen_cabinets_back.png",t),r=new n.StandardMaterial("cabinets_back",t);r.diffuseTexture=e;const a=[.1,.1,.1,.1],i=p(0,[0,0,1.2,0,1.2,.2,1.8,.2,1.8,0,2.4,0,2.4,1.4,0,1.4],[],.4,r,"front",[[0,0,1,1],a,a,a,a,a]);i.position.set(0,1.4,2.6),i.parent=o}{const e=new n.Texture("textures/kitchen_cabinets_side.png",t),r=new n.StandardMaterial("cabinets_back",t);r.diffuseTexture=r.ambientTexture=e;const a=[.1,.1,.1,.1],i=s("upper_cabinets2",[2,.6,.4],[-.8,2.2,1.4],r,[a,[0,1,1,0],a,a,a,a]);i.rotation.y=-Math.PI/2,i.parent=o}o.parent=e})(t,o)}}{const e=new n.TransformNode("upper_floor",o);e.parent=r,e.position.y=3.2;(function(e,t){const o=new n.TransformNode("ground_walls");o.parent=e;{const t=p(0,[0,0,d(3.2,.8,2.1),6.1,0,6.1,2.8,0,2.8],[],.15,i.interior,"back");t.position.set(6.25,0,3.15),t.parent=e,s("wall_mbr_front",[1.65,2.8,.15],[6.1,0,1.35],i.wall).parent=e,s("wall_mbr_connect",[.15,2.8,1.5],[6.1,0,1.5],i.wall).parent=e;const o=p(0,[0,0,d(2,.7,2.1),2.85,0,2.85,2.8,0,2.8],[],.15,i.wall,"right");o.position.set(1.6,0,.15),o.parent=e}{s("front_left",[3.15,2.8,.15],[.15,0,5.95],i.wall).parent=e;const t=p(0,[0,0,d(.15,.8,2.1),4.15,0,4.15,2.8,0,2.8],[],.15,i.wall,"front");t.position.set(3.3,0,7.15),t.parent=e;const o=p(0,[0,0,d(.05,.8,2.1),4.05,0,4.05,2.8,0,2.8],[],.15,i.wall,"right");o.position.set(3.3,0,6.1),o.parent=e;const n=p(0,[0,0,d(.25,.7,2.1),2.65,0,2.65,2.8,0,2.8],[],.15,i.wall,"front");n.position.set(4.8,0,5.65),n.parent=e,s("",[.15,2.8,1.35],[4.8,0,5.8],i.wall).parent=e}})(e)}r.position.set(t[0],t[1],t[2]),r.parent=e}(t,[1.85,.4,2.85],e),f(.2,0,9).position.set(.15,3.6,9),f(.2,0,24.2).position.set(.15,3.6,0),f(0,.2,6.7).position.set(5,3.6,0),f(.2,0,22).position.set(5,3.6,1.35),f(0,.2,7.5).position.set(9.45,3.6,1.35),s("balcony_separator",[.1,2.1,1.5],[4.95,3.6,1.35],i.wall),new g(t,e),f(.2,0,53.5).parent=t,function(e,t){const o=new n.StandardMaterial("floor0_mat",t);o.diffuseTexture=_;const r=n.MeshBuilder.CreateGround("floor0_ref",{width:10.8,height:15},t);r.material=o,r.position=new n.Vector3(5.4,.001,7.5)}(0,e),function(e,t){{const o=new n.StandardMaterial("floor1_mat",t);o.diffuseTexture=x;const r=10.8,a=15,i=.2/r,s=.2/a,l=p(0,[.15,0,5,0,5,1.35,9.45,1.35,9.45,2.85,9.3,2.85,9.3,4.35,8.1,4.35,8.1,7.45,9.3,7.45,9.3,13,2,13,2,9,.15,9],[],.4,o,"top",[[.15/r,0/a,9.45/r,13/a],[i,s,i,s],[i,s,i,s]]);l.position.set(0,3.6,0),l.parent=e}}(t,e),t})(k).position.x=0,function(){const e=document.getElementById("bMenu"),t=document.getElementById("divMenu"),o=document.createElement("div");function n(e){t.style.display=e?"":"none"}function r(e,t,n){const r=document.createElement("button");r.innerText=e,r.onclick=()=>{S.position.toArray(A.fromPos),S.rotation.toArray(A.fromRot),A.toPos.set(t),A.toRot.set(n),A.interp=0},o.appendChild(r)}function a(e,t){const o=document.createElement("button");o.innerText=e,o.onclick=()=>{S.position.toArray(A.fromPos),S.position.toArray(A.toPos),S.rotation.toArray(A.fromRot),S.rotation.toArray(A.toRot),A.toPos[1]=t,A.interp=0},document.getElementById("divNav").appendChild(o)}o.style.cssText="display: flex; flex-direction: column; gap: 0.5em;",t.appendChild(o),e.onclick=()=>{t.offsetParent?n(!1):n(!0)},window.addEventListener("touchstart",e=>{S.position.toArray(I),S.rotation.toArray(B),P.dragStartX=e.touches[0].clientX,P.dragStartY=e.touches[0].clientY}),window.addEventListener("touchend",e=>{P.dragging=!1}),window.addEventListener("touchmove",e=>{P.dragging=!0,P.x=e.touches[0].clientX,P.y=e.touches[0].clientY}),r("Front",[5.5,1.6,-10],[0,0,0]),r("Living area",[4.14,2,6.54],[0,1.94,0]),r("Upper floor, MBR",[5.03,4.9,5.64],[0,2.23,0]),a("Roof",7.6),a("Upper floor",5.2),a("Ground floor",2),a("Terrain",1.6)}(),k.registerBeforeRender(()=>{if(A.interp<1){A.interp+=.02,A.interp>=1&&(A.interp=1);const e=A.interp,t=1-e,o=A.fromPos[0]*t+A.toPos[0]*e,n=A.fromPos[1]*t+A.toPos[1]*e,r=A.fromPos[2]*t+A.toPos[2]*e,a=A.fromRot[0]*t+A.toRot[0]*e,i=A.fromRot[1]*t+A.toRot[1]*e,s=A.fromRot[2]*t+A.toRot[2]*e;S.position.set(o,n,r),S.rotation.set(a,i,s)}const e=S.getDirection(n.Vector3.Forward());if(P.dragging){const t=.01,o=-.001,n=(P.x-P.dragStartX)*o,r=-(P.y-P.dragStartY)*t;S.position.set(I[0]-r*e.x,I[1],I[2]-r*e.z),S.rotation.y=B[1]+n}}),window.addEventListener("keydown",(function(e){switch(e.key.toUpperCase()){case"R":S.position=T(),S.rotation=new n.Vector3;break;case"0":S.position.y=1.6;break;case"1":S.position.y=2;break;case"2":S.position.y=r+1.6;break;case"3":S.position.y=8.4;break;case"4":if(e.ctrlKey){const e=new Array;S.position.toArray(e),localStorage.setItem("metropolis",JSON.stringify(e))}else{const e=JSON.parse(localStorage.getItem("metropolis"));S.position.set(e[0],e[1],e[2])}break;case"L":{const e=S.position,t=S.rotation,o=[e.x,e.y,e.z].map(e=>Math.round(100*e)/100),n=[t.x,t.y,t.z].map(e=>Math.round(100*e)/100);document.getElementById("divMessage").innerHTML=`position: ${o} rotation: ${n}`}break;case"S":{const e=S.position,t=S.rotation,o=[e.x,e.y,e.z].map(e=>Math.round(100*e)/100),n=[t.x,t.y,t.z].map(e=>Math.round(100*e)/100);localStorage.setItem("savedLocation",JSON.stringify({pos:o,rot:n}))}break;case"P":{const e=JSON.parse(localStorage.getItem("savedLocation")),t=e.pos,o=e.rot;S.position.set(t[0],t[1],t[2]),S.rotation.set(o[0],o[1],o[2])}}})),window.onresize=()=>C.resize()}]);